# 🔐 管理員系統使用指南

## 概述

HomeBank V2 現在包含完整的管理員系統，允許系統管理員管理所有註冊用戶。

## 管理員功能

### 1. 用戶管理
- ✅ 查看所有用戶（管理員、父母、子女）
- ✅ 新增任何角色的用戶
- ✅ 刪除用戶（除了自己）
- ✅ 重設任何用戶的密碼
- ✅ 查看用戶統計資料

### 2. 系統統計
- 總用戶數
- 管理員數量
- 父母帳號數量
- 子女帳號數量

## 預設管理員帳號

初始化資料庫後會自動建立管理員帳號：

```
Email: admin@homebank.com
密碼: Admin@123
```

⚠️ **重要**: 首次登入後請立即修改密碼！

## 訪問管理後台

1. 使用管理員帳號登入
2. 系統會自動導向管理後台：`/admin-dashboard`
3. 非管理員帳號無法訪問此頁面

## 角色權限

### Admin (管理員)
- 所有系統權限
- 管理所有用戶
- 重設任何用戶密碼
- 查看系統統計

### Parent (父母)
- 管理自己家庭的工作和獎勵
- 管理子女帳號
- 審核子女完成的工作

### Child (子女)
- 查看和完成工作
- 兌換獎勵
- 查看點數記錄

## 新增用戶

管理員可以新增任何角色的用戶：

1. 點擊「新增用戶」按鈕
2. 填寫用戶資訊：
   - 姓名
   - Email
   - 密碼（需符合安全要求）
   - 角色（管理員/父母/子女）
3. 點擊「新增」

### 密碼安全要求

所有密碼必須包含：
- 至少 8 個字元
- 大寫字母 (A-Z)
- 小寫字母 (a-z)
- 數字 (0-9)
- 特殊字元 (!@#$%^&* 等)

## 重設用戶密碼

管理員可以重設任何用戶的密碼：

1. 在用戶列表中找到目標用戶
2. 點擊「重設密碼」
3. 輸入新密碼（需符合安全要求）
4. 點擊「重設密碼」確認

⚠️ **注意**: 重設密碼後，用戶需要使用新密碼登入。

## 刪除用戶

管理員可以刪除任何用戶（除了自己）：

1. 在用戶列表中找到目標用戶
2. 點擊「刪除」
3. 確認刪除操作

⚠️ **警告**: 刪除操作無法復原！

## API 端點

### 管理員專用 API

```
GET    /api/admin/users              # 取得所有用戶和統計
POST   /api/admin/users              # 新增用戶（任何角色）
PUT    /api/admin/users              # 更新用戶資訊
DELETE /api/admin/users?id={userId}  # 刪除用戶
POST   /api/admin/reset-password     # 重設用戶密碼
```

## 安全性

### 密碼加密
- 所有密碼使用 bcrypt 雜湊（salt rounds: 12）
- 密碼永不以明文儲存
- 即使資料庫洩露也無法還原密碼

### 權限控制
- 前端檢查用戶角色
- 後端 API 應加入權限驗證（建議）
- 管理員頁面僅限管理員訪問

### 建議的安全措施

1. **首次登入後立即修改管理員密碼**
2. **定期更換管理員密碼**
3. **不要分享管理員帳號**
4. **監控用戶活動**
5. **定期備份資料**

## 資料儲存

所有用戶資料儲存在 Vercel Blob Storage：

```
Blob Storage
└── homebank/
    └── users.json  # 包含所有用戶資料（密碼已雜湊）
```

## 故障排除

### 無法訪問管理後台

**問題**: 登入後無法進入管理後台

**解決方案**:
1. 確認使用的是管理員帳號
2. 檢查 localStorage 中的用戶角色
3. 清除瀏覽器快取後重新登入

### 無法重設密碼

**問題**: 重設密碼時顯示「密碼強度不足」

**解決方案**:
1. 確保密碼至少 8 個字元
2. 包含大寫、小寫、數字、特殊字元
3. 不要使用常見弱密碼

### 刪除用戶失敗

**問題**: 無法刪除某個用戶

**解決方案**:
1. 確認不是嘗試刪除自己的帳號
2. 檢查網路連線
3. 查看瀏覽器 Console 的錯誤訊息

## 未來改進建議

- [ ] 加入用戶活動日誌
- [ ] 批量操作功能
- [ ] 匯出用戶資料
- [ ] 進階搜尋和篩選
- [ ] 用戶權限細粒度控制
- [ ] 雙因素認證 (2FA)
- [ ] API 權限驗證中介層

## 相關文件

- [FEATURES.md](./FEATURES.md) - 功能說明
- [DEPLOYMENT_CHECKLIST.md](./DEPLOYMENT_CHECKLIST.md) - 部署指南
- [VERCEL_BLOB_DEPLOYMENT.md](./VERCEL_BLOB_DEPLOYMENT.md) - Blob Storage 設定
